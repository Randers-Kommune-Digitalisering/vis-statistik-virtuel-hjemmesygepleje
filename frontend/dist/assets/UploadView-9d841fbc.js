import{_ as V,r as o,o as f,c as m,b as s,t as b,k as v,y as I,F as z,j as B,z as x,v as w,A as C,p as W,f as j,g as O,d as H}from"./index-84fe410d.js";import{h}from"./moment-fbc5633a.js";const S=i=>(W("data-v-52e6922a"),i=i(),j(),i),L={class:"upload"},N=S(()=>s("h1",null,"Upload fil",-1)),A=["onSubmit"],E={class:"form-group"},K=S(()=>s("label",{for:"filetype"},"Filtype",-1)),P=["value"],q=["disabled"],G={__name:"Upload",setup(i){const n=[{value:"unknown",text:"Ukendt"},{value:"tablets_knox",text:"Samsung Knox"},{value:"video_calls",text:"Vitacomm"},{value:"citizens",text:"Borgere"},{value:"tablets_nexus",text:"Skærme"}],l=o({value:"unknown",text:"Ukendt"}),_=o(!1),g=o(!1),k=o(null),d=o(null);let u=new Date,D=u.getMinutes()-u.getTimezoneOffset();u.setMinutes(D);const p=o(u.toISOString().slice(0,16));let c=new Date;c.setDate(c.getDate()-7);const r=o(u.getFullYear()+"-W"+h(c).isoWeek());function U(a){if(g.value=!(a.target.files.length<1),a.target.files.length>0){let t=a.target.files[0].name.split(".");t.pop();const e=t.join(".");if(e.includes("video"))l.value=n[2];else if(e.includes("Device_List")){let T=e.split("_").slice(-1)[0],Y=h(T,"YYYY-MM-DD HH.mm.ss").format("YYYY-MM-DDTkk:mm").toString();p.value=Y,l.value=n[1]}else e.includes("borger")?l.value=n[3]:e.includes("skærm")?l.value=n[4]:(l.value,n[0])}k.value=a.target.files[0],y()}function y(){_.value=l.value.value!=="unknown"}function F(){return!(_.value&&g.value)}async function M(){d.value="";let a=new FormData;a.append("file",k.value),a.append("filetype",l.value.value),a.append("datetime",p.value),a.append("week",r.value);const e=await(await fetch("/file-upload",{method:"POST",body:a})).json();d.value=e.message}return(a,t)=>(f(),m("div",L,[N,s("h2",null,b(d.value),1),s("form",{onSubmit:C(M,["prevent"])},[s("input",{id:"fileUpload",onChange:t[0]||(t[0]=e=>U(e)),ref:"fileInput",type:"file",accept:".csv",class:"file-input"},null,544),s("div",E,[K,v(s("select",{onChange:t[1]||(t[1]=e=>y()),"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.value=e),class:"file-type-select"},[(f(),m(z,null,B(n,e=>s("option",{key:e.value,value:e.value,class:"file-type-select"},b(e.text),9,P)),64))],544),[[I,l.value.value]])]),v(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),type:"datetime-local",class:"time-input"},null,512),[[x,l.value.value==="tablets_knox"],[w,p.value]]),v(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.value=e),type:"week",class:"time-input"},null,512),[[x,l.value.value==="citizens"||l.value.value==="tablets_nexus"],[w,r.value]]),s("input",{disabled:F(),type:"submit",value:"Upload",class:"submit-button"},null,8,q)],40,A)]))}},J=V(G,[["__scopeId","data-v-52e6922a"]]),X=O({__name:"UploadView",setup(i){return(n,l)=>(f(),m("main",null,[H(J)]))}});export{X as default};
